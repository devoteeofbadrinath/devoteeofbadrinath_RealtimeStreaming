pipeline_task_id,pipeline_name,pipeline_task_name,query_order,transformation_step,database_type,sql_query,temp_table_name,read_in_batches,version,last_updated,last_updated_by
cde_bkkg_acntbal_brdj_stream,cde_bkkg_acntbal_brdj_stream,stream_load,1,normalise,sparksql,"SELECT Data.MessageHeader.Timestamp,Data.MessageHeader.BusCorID,Data.MessageHeader.LocRefNum,Data.MessageHeader.RetAdd,Data.MessageHeader.SeqNum,Data.MessageHeader.ReqRef,Data.MessageHeader.OriSou,Data.MessageHeader.EventAction,Data.MessageBody.AccArr.AccNum,Data.MessageBody.AccArr.Balance,Data.MessageBody.AccArr.BalanceStatus, Data.MessageBody.Branch.NSC FROM global_temp.stream_df where Data.MessageHeader.OriSou='BKK'",parsed_df,,1,2023--11-04,c138147
cde_bkkg_acntbal_brdj_stream,cde_bkkg_acntbal_brdj_stream,stream_load,2,transform,sparksql,"select * from ( select *, row_number() over (partition by AccNum, NSC order by timestamp desc) as rn from parsed_df ) tmp where rn = 1",source_df_with_latest_accounts,,1,2023--11-04,c138147
cde_bkkg_acntbal_brdj_stream,cde_bkkg_acntbal_brdj_stream,stream_load,3,transform,phoenix,BRDJ_USECASE_REFERENCE_FILES.ACNT,existing_df_full,,1,2023--11-04,c138147